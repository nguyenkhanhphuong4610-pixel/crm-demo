<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Spa CRM ‚Äì Professional Demo</title>

<style>
body{font-family:Arial;background:#f4f6f8;padding:20px}
.container{max-width:1200px;margin:auto}
h1{color:#e91e63}
.card{background:#fff;padding:15px;border-radius:10px;margin-bottom:20px}
input,select,textarea,button{width:100%;padding:8px;margin-top:6px}
button{background:#e91e63;color:#fff;border:none;border-radius:6px;cursor:pointer}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ddd;padding:8px;text-align:center}
th{background:#fde4ec}
.badge{padding:4px 8px;border-radius:5px;color:#fff;font-size:12px}
.doing{background:#ff9800}
.done{background:#4caf50}
img.preview{max-width:45%;border:1px solid #ddd;border-radius:6px}
.flex{display:flex;gap:10px;flex-wrap:wrap}
.hidden{display:none}
a{color:#e91e63;cursor:pointer;text-decoration:none}
</style>
</head>

<body>
<div class="container">

<!-- ====== LIST PAGE ====== -->
<div id="listPage">
<h1>üå∏ Qu·∫£n l√Ω kh√°ch h√†ng Spa</h1>

<div class="card">
<input id="search" placeholder="üîç T√¨m theo t√™n ho·∫∑c SƒêT" oninput="renderList()">
</div>

<div class="card">
<table>
<thead>
<tr>
<th>T√™n</th>
<th>SƒêT</th>
<th>D·ªãch v·ª•</th>
<th>Gi√°</th>
<th>Tr·∫°ng th√°i</th>
<th>H·ªì s∆°</th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>
</div>
</div>

<!-- ====== DETAIL PAGE ====== -->
<div id="detailPage" class="hidden">
<a onclick="goHome()">‚Üê Quay l·∫°i danh s√°ch</a>
<div class="card" id="detail"></div>
</div>

</div>

<script>
let customers = JSON.parse(localStorage.getItem("spaCRM")) || [];

function renderList(){
  const key = search.value.toLowerCase();
  list.innerHTML="";
  customers
    .filter(c=>c.name.toLowerCase().includes(key)||c.phone.includes(key))
    .forEach(c=>{
      list.innerHTML+=`
      <tr>
        <td>${c.name}</td>
        <td>${c.phone}</td>
        <td>${c.service}</td>
        <td>${c.price?.toLocaleString()||0}ƒë</td>
        <td><span class="badge ${c.status}">
          ${c.status==="doing"?"ƒêang l√†m":"Ho√†n th√†nh"}
        </span></td>
        <td>
          <a onclick="openCustomer(${c.id})">M·ªü</a>
        </td>
      </tr>`;
    });
}

function openCustomer(id){
  location.hash = "customer-" + id;
}

function goHome(){
  location.hash = "";
}

function renderDetail(id){
  const c = customers.find(x=>x.id==id);
  if(!c) return;

  detail.innerHTML=`
    <h2>${c.name}</h2>
    <p><b>SƒêT:</b> ${c.phone}</p>
    <p><b>Sinh nh·∫≠t:</b> ${c.birthday||"-"}</p>
    <p><b>D·ªãch v·ª•:</b> ${c.service}</p>
    <p><b>Gi√°:</b> ${c.price?.toLocaleString()||0}ƒë</p>
    <p><b>NV t∆∞ v·∫•n:</b> ${c.consultant||"-"}</p>
    <p><b>NV chƒÉm s√≥c:</b> ${c.staff||"-"}</p>
    <p><b>Ng√†y h·∫πn ti·∫øp:</b> ${c.nextDate||"-"}</p>

    <h3>L·ªô tr√¨nh chƒÉm s√≥c</h3>
    <ul>${(c.roadmap||[]).map(r=>`<li>${r}</li>`).join("")}</ul>

    <h3>Before / After</h3>
    <div class="flex">
      ${c.beforeImg?`<img src="${c.beforeImg}" class="preview">`:""}
      ${c.afterImg?`<img src="${c.afterImg}" class="preview">`:""}
    </div>
  `;
}

function router(){
  if(location.hash.startsWith("#customer-")){
    const id = location.hash.replace("#customer-","");
    listPage.classList.add("hidden");
    detailPage.classList.remove("hidden");
    renderDetail(id);
  } else {
    detailPage.classList.add("hidden");
    listPage.classList.remove("hidden");
    renderList();
  }
}

window.addEventListener("hashchange", router);
router();
</script>

</body>
</html>